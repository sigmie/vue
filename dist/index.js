(function(o,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(o=typeof globalThis<"u"?globalThis:o||self,r(o["@sigmie-vue"]={},o.Vue))})(this,function(o,r){"use strict";const f={__name:"SigmieSearch",props:{url:{type:String,default:null},search:{type:String,default:""},applicationId:{type:String,default:""},apiKey:{type:String,default:""},page:{type:Number,default:1},query:{type:String,default:""},filters:{type:String,default:""},facets:{type:String,default:""},perPage:{type:Number,default:10},sort:{type:String,default:"_score"},debounceMs:{type:Number,default:150}},setup(s){let e=s,a=r.reactive({autocomplete:[],hits:{},total:0,page:1,loading:!1,inited:!1,facets:{},processing_time_ms:0,per_page:10,last_page:0,current_page:1,from:0,to:0});r.onBeforeMount(()=>{c.value=[`https://${e.applicationId}-a.sigmie.app/v1/search/${e.search}`,`https://${e.applicationId}-b.sigmie.app/v1/search/${e.search}`,`https://${e.applicationId}-c.sigmie.app/v1/search/${e.search}`],u()});let c=r.ref([]),p=0;function g(){const i=c.value[p];return p=(p+1)%c.value.length,i}function d(i,l){let n;return function(...t){n&&clearTimeout(n),n=setTimeout(()=>{i(...t)},l)}}let u=function(i=3){a.loading=!0;const l={query:e.query,per_page:e.perPage,filters:e.filters,facets:e.facets,page:e.page,sort:e.sort},n=e.url?e.url:g();fetch(n,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json","X-Sigmie-API-Key":e.apiKey,"X-Sigmie-Application":e.applicationId},redirect:"follow",body:JSON.stringify(l)}).then(t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()}).then(t=>{if(t.error)throw new Error(t.message,{cause:t});a.hits=t.hits,a.total=t.total,a.facets=t.facets,a.page=t.page,a.autocomplete=t.autocomplete,a.processing_time_ms=t.processing_time_ms,a.current_page=t.page,a.last_page=Math.ceil(t.total/e.perPage),a.from=(t.page-1)*e.perPage+1,a.to=Math.min(t.page*e.perPage,t.total),a.per_page=t.perPage,a.loading=!1,a.inited=!0}).catch(t=>{console.error("Fetch error:",t),!e.url&&i>1?u(i-1):a.loading=!1})};return r.watch(e,d(u,e.debounceMs)),(i,l)=>r.unref(a).inited?r.renderSlot(i.$slots,"default",r.normalizeProps(r.mergeProps({key:0},r.unref(a)))):r.createCommentVNode("",!0)}};o.SigmieSearch=f,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
