(function(r,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(r=typeof globalThis<"u"?globalThis:r||self,i(r["@sigmie-vue"]={},r.Vue))})(this,function(r,i){"use strict";const u={__name:"SigmieSearch",props:{url:{type:String,default:null},search:{type:String,default:""},applicationId:{type:String,default:""},apiKey:{type:String,default:""},page:{type:Number,default:1},query:{type:String,default:""},filters:{type:String,default:""},facets:{type:String,default:""},perPage:{type:Number,default:10},sort:{type:String,default:"_score"},debounceMs:{type:Number,default:150}},setup(f){let e=f,a=i.reactive({autocomplete:[],hits:{},total:0,page:1,loading:!1,inited:!1,facets:{},processing_time_ms:0,per_page:10,last_page:0,current_page:1,from:0,to:0});i.onBeforeMount(()=>{l.value=[`https://${e.applicationId}-a.sigmie.app/v1/search/${e.search}`,`https://${e.applicationId}-b.sigmie.app/v1/search/${e.search}`,`https://${e.applicationId}-c.sigmie.app/v1/search/${e.search}`],c()});let l=i.ref([]),p=0;function g(){const n=l.value[p];return p=(p+1)%l.value.length,n}function s(n,o){let t;return function(...d){t&&clearTimeout(t),t=setTimeout(()=>{n(...d)},o)}}let c=function(){a.loading=!0;const n={query:e.query,per_page:e.perPage,filters:e.filters,facets:e.facets,page:e.page,sort:e.sort},o=e.url?e.url:g();fetch(o,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json","X-Sigmie-API-Key":e.apiKey,"X-Sigmie-Application":e.applicationId},redirect:"follow",body:JSON.stringify(n)}).then(t=>t.json()).then(t=>{if(t.error)throw new Error(t.message,{cause:t});a.hits=t.hits,a.total=t.total,a.facets=t.facets,a.page=t.page,a.autocomplete=t.autocomplete,a.processing_time_ms=t.processing_time_ms,a.current_page=t.page,a.last_page=Math.ceil(t.total/e.perPage),a.from=(t.page-1)*e.perPage+1,a.to=Math.min(t.page*e.perPage,t.total),a.per_page=t.perPage,a.loading=!1,a.inited=!0})};return i.watch(e,s(c,e.debounceMs)),(n,o)=>i.unref(a).inited?i.renderSlot(n.$slots,"default",i.normalizeProps(i.mergeProps({key:0},i.unref(a)))):i.createCommentVNode("",!0)}};r.SigmieSearch=u,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
